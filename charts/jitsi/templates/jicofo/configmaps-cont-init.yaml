apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "jitsi-meet.jicofo.fullname" . }}-cont-inits
  labels:
    {{- include "jitsi-meet.jicofo.labels" . | nindent 4 }}
data:
  10-config: |
    {{- if .Values.jicofo.custom.contInit._10_config }}
      {{- .Values.jicofo.custom.contInit._10_config | nindent 4 }}
    {{- else }}
    # Using jicofo /etc/cont-init.d/10-config from container image
    {{ end }}
  20-rest-config: |
    #!/bin/bash
    {{- if .Values.jicofo.rest.enabled }}
    # Append REST configuration to jicofo.conf
    cat >> /config/jicofo.conf << 'EOF'

    jicofo {
      rest {
        host = "{{ .Values.jicofo.rest.host }}"
        port = {{ .Values.jicofo.rest.port }}
      }
    }
    EOF
    echo "Added REST configuration to jicofo.conf"
    {{- else }}
    echo "REST API not enabled, skipping"
    {{- end }}

